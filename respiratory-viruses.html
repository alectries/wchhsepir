<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 4 Respiratory Viruses | In-Service Presentation, August 2024</title>
  <meta name="description" content="Section 4 Respiratory Viruses | In-Service Presentation, August 2024" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 4 Respiratory Viruses | In-Service Presentation, August 2024" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 4 Respiratory Viruses | In-Service Presentation, August 2024" />
  
  
  

<meta name="author" content="Alec Higgins" />


<meta name="date" content="2024-08-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="stis.html"/>
<link rel="next" href="bookdown.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Alec Higgins In-Service Presentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sections"><i class="fa fa-check"></i>Sections</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="cd-report.html"><a href="cd-report.html"><i class="fa fa-check"></i><b>1</b> 2024 CD Report</a>
<ul>
<li class="chapter" data-level="1.1" data-path="cd-report.html"><a href="cd-report.html#libraries"><i class="fa fa-check"></i><b>1.1</b> Libraries</a></li>
<li class="chapter" data-level="1.2" data-path="cd-report.html"><a href="cd-report.html#settings"><i class="fa fa-check"></i><b>1.2</b> Settings</a></li>
<li class="chapter" data-level="1.3" data-path="cd-report.html"><a href="cd-report.html#reading-data-then-saving"><i class="fa fa-check"></i><b>1.3</b> Reading data, then saving</a></li>
<li class="chapter" data-level="1.4" data-path="cd-report.html"><a href="cd-report.html#combining-and-saving-data"><i class="fa fa-check"></i><b>1.4</b> Combining and saving data</a></li>
<li class="chapter" data-level="1.5" data-path="cd-report.html"><a href="cd-report.html#extracting-and-exporting-demographic-data-from-a-line-list"><i class="fa fa-check"></i><b>1.5</b> Extracting and exporting demographic data from a line list</a></li>
<li class="chapter" data-level="1.6" data-path="cd-report.html"><a href="cd-report.html#tabulating-demographic-data"><i class="fa fa-check"></i><b>1.6</b> Tabulating demographic data</a></li>
<li class="chapter" data-level="1.7" data-path="cd-report.html"><a href="cd-report.html#calculating-incidence-by-zip-code"><i class="fa fa-check"></i><b>1.7</b> Calculating incidence by ZIP code</a></li>
<li class="chapter" data-level="1.8" data-path="cd-report.html"><a href="cd-report.html#generating-counts-and-rates-tables"><i class="fa fa-check"></i><b>1.8</b> Generating counts and rates tables</a></li>
<li class="chapter" data-level="1.9" data-path="cd-report.html"><a href="cd-report.html#final-notes"><i class="fa fa-check"></i><b>1.9</b> Final notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mch-report.html"><a href="mch-report.html"><i class="fa fa-check"></i><b>2</b> 2024 MCH Report</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mch-report.html"><a href="mch-report.html#libraries-1"><i class="fa fa-check"></i><b>2.1</b> Libraries</a></li>
<li class="chapter" data-level="2.2" data-path="mch-report.html"><a href="mch-report.html#transposing-data"><i class="fa fa-check"></i><b>2.2</b> Transposing data</a></li>
<li class="chapter" data-level="2.3" data-path="mch-report.html"><a href="mch-report.html#importing-data"><i class="fa fa-check"></i><b>2.3</b> Importing data</a></li>
<li class="chapter" data-level="2.4" data-path="mch-report.html"><a href="mch-report.html#cleaning-and-combining-data"><i class="fa fa-check"></i><b>2.4</b> Cleaning and combining data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="mch-report.html"><a href="mch-report.html#prenatal-care-initiation-by-maternal-age"><i class="fa fa-check"></i><b>2.4.1</b> Prenatal care initiation by maternal age</a></li>
<li class="chapter" data-level="2.4.2" data-path="mch-report.html"><a href="mch-report.html#prenatal-care-initiation-by-maternal-education"><i class="fa fa-check"></i><b>2.4.2</b> Prenatal care initiation by maternal education</a></li>
<li class="chapter" data-level="2.4.3" data-path="mch-report.html"><a href="mch-report.html#prenatal-care-initiation-by-marital-status"><i class="fa fa-check"></i><b>2.4.3</b> Prenatal care initiation by marital status</a></li>
<li class="chapter" data-level="2.4.4" data-path="mch-report.html"><a href="mch-report.html#prenatal-care-initiation-by-maternal-race-and-ethnicity"><i class="fa fa-check"></i><b>2.4.4</b> Prenatal care initiation by maternal race and ethnicity</a></li>
<li class="chapter" data-level="2.4.5" data-path="mch-report.html"><a href="mch-report.html#birthweight-by-prenatal-care-initiation"><i class="fa fa-check"></i><b>2.4.5</b> Birthweight by prenatal care initiation</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="mch-report.html"><a href="mch-report.html#exporting-data"><i class="fa fa-check"></i><b>2.5</b> Exporting data</a></li>
<li class="chapter" data-level="2.6" data-path="mch-report.html"><a href="mch-report.html#graphing-data"><i class="fa fa-check"></i><b>2.6</b> Graphing data</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="mch-report.html"><a href="mch-report.html#prenatal-care-initiation-by-maternal-age-1"><i class="fa fa-check"></i><b>2.6.1</b> Prenatal care initiation by maternal age</a></li>
<li class="chapter" data-level="2.6.2" data-path="mch-report.html"><a href="mch-report.html#prenatal-care-initiation-by-maternal-education-1"><i class="fa fa-check"></i><b>2.6.2</b> Prenatal care initiation by maternal education</a></li>
<li class="chapter" data-level="2.6.3" data-path="mch-report.html"><a href="mch-report.html#prenatal-care-initiation-by-marital-status-1"><i class="fa fa-check"></i><b>2.6.3</b> Prenatal care initiation by marital status</a></li>
<li class="chapter" data-level="2.6.4" data-path="mch-report.html"><a href="mch-report.html#prenatal-care-initiation-by-race-and-ethnicity"><i class="fa fa-check"></i><b>2.6.4</b> Prenatal care initiation by race and ethnicity</a></li>
<li class="chapter" data-level="2.6.5" data-path="mch-report.html"><a href="mch-report.html#birthweight-by-prenatal-care-initiation-1"><i class="fa fa-check"></i><b>2.6.5</b> Birthweight by prenatal care initiation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="mch-report.html"><a href="mch-report.html#calculating-risk-ratios-for-early-prenatal-care"><i class="fa fa-check"></i><b>2.7</b> Calculating risk ratios for early prenatal care</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="mch-report.html"><a href="mch-report.html#risk-of-prenatal-care-initiation-by-maternal-age"><i class="fa fa-check"></i><b>2.7.1</b> Risk of prenatal care initiation by maternal age</a></li>
<li class="chapter" data-level="2.7.2" data-path="mch-report.html"><a href="mch-report.html#risk-of-prenatal-care-initiation-by-maternal-education"><i class="fa fa-check"></i><b>2.7.2</b> Risk of prenatal care initiation by maternal education</a></li>
<li class="chapter" data-level="2.7.3" data-path="mch-report.html"><a href="mch-report.html#risk-of-prenatal-care-initiation-by-marital-status"><i class="fa fa-check"></i><b>2.7.3</b> Risk of prenatal care initiation by marital status</a></li>
<li class="chapter" data-level="2.7.4" data-path="mch-report.html"><a href="mch-report.html#risk-of-prenatal-care-initiation-by-race-and-ethnicity"><i class="fa fa-check"></i><b>2.7.4</b> Risk of prenatal care initiation by race and ethnicity</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="mch-report.html"><a href="mch-report.html#final-notes-1"><i class="fa fa-check"></i><b>2.8</b> Final notes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="stis.html"><a href="stis.html"><i class="fa fa-check"></i><b>3</b> STIs</a>
<ul>
<li class="chapter" data-level="3.1" data-path="stis.html"><a href="stis.html#libraries-2"><i class="fa fa-check"></i><b>3.1</b> Libraries</a></li>
<li class="chapter" data-level="3.2" data-path="stis.html"><a href="stis.html#importing-chlamydia-data"><i class="fa fa-check"></i><b>3.2</b> Importing chlamydia data</a></li>
<li class="chapter" data-level="3.3" data-path="stis.html"><a href="stis.html#filtering-data-to-exclude-non-wake-cases"><i class="fa fa-check"></i><b>3.3</b> Filtering data to exclude non-Wake cases</a></li>
<li class="chapter" data-level="3.4" data-path="stis.html"><a href="stis.html#loading-census-data"><i class="fa fa-check"></i><b>3.4</b> Loading census data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="stis.html"><a href="stis.html#loading-age-data"><i class="fa fa-check"></i><b>3.4.1</b> Loading age data</a></li>
<li class="chapter" data-level="3.4.2" data-path="stis.html"><a href="stis.html#loading-race-and-ethnicity-data"><i class="fa fa-check"></i><b>3.4.2</b> Loading race and ethnicity data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="stis.html"><a href="stis.html#tally-cases-by-group-and-calculate-incidence"><i class="fa fa-check"></i><b>3.5</b> Tally cases by group and calculate incidence</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="stis.html"><a href="stis.html#chlamydia-incidence-by-age-group"><i class="fa fa-check"></i><b>3.5.1</b> Chlamydia incidence by age group</a></li>
<li class="chapter" data-level="3.5.2" data-path="stis.html"><a href="stis.html#chlamydia-incidence-by-race"><i class="fa fa-check"></i><b>3.5.2</b> Chlamydia incidence by race</a></li>
<li class="chapter" data-level="3.5.3" data-path="stis.html"><a href="stis.html#chlamydia-count-by-municipality"><i class="fa fa-check"></i><b>3.5.3</b> Chlamydia count by municipality</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="stis.html"><a href="stis.html#graphing-chlamydia"><i class="fa fa-check"></i><b>3.6</b> Graphing chlamydia</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="stis.html"><a href="stis.html#chlamydia-incidence-by-age-group-1"><i class="fa fa-check"></i><b>3.6.1</b> Chlamydia incidence by age group</a></li>
<li class="chapter" data-level="3.6.2" data-path="stis.html"><a href="stis.html#chlamydia-incidence-by-race-1"><i class="fa fa-check"></i><b>3.6.2</b> Chlamydia incidence by race</a></li>
<li class="chapter" data-level="3.6.3" data-path="stis.html"><a href="stis.html#chlamydia-count-by-municipality-1"><i class="fa fa-check"></i><b>3.6.3</b> Chlamydia count by municipality</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="stis.html"><a href="stis.html#tallying-and-graphing-gonorrhea"><i class="fa fa-check"></i><b>3.7</b> Tallying and graphing gonorrhea</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="stis.html"><a href="stis.html#importing"><i class="fa fa-check"></i><b>3.7.1</b> Importing</a></li>
<li class="chapter" data-level="3.7.2" data-path="stis.html"><a href="stis.html#filtering"><i class="fa fa-check"></i><b>3.7.2</b> Filtering</a></li>
<li class="chapter" data-level="3.7.3" data-path="stis.html"><a href="stis.html#tallying"><i class="fa fa-check"></i><b>3.7.3</b> Tallying</a></li>
<li class="chapter" data-level="3.7.4" data-path="stis.html"><a href="stis.html#graphing-gonorrhea-incidence-by-age-group"><i class="fa fa-check"></i><b>3.7.4</b> Graphing gonorrhea incidence by age group</a></li>
<li class="chapter" data-level="3.7.5" data-path="stis.html"><a href="stis.html#graphing-gonorrhea-incidence-by-race"><i class="fa fa-check"></i><b>3.7.5</b> Graphing gonorrhea incidence by race</a></li>
<li class="chapter" data-level="3.7.6" data-path="stis.html"><a href="stis.html#graphing-gonorrhea-count-by-municipality"><i class="fa fa-check"></i><b>3.7.6</b> Graphing gonorrhea count by municipality</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="stis.html"><a href="stis.html#final-notes-2"><i class="fa fa-check"></i><b>3.8</b> Final notes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html"><i class="fa fa-check"></i><b>4</b> Respiratory Viruses</a>
<ul>
<li class="chapter" data-level="4.1" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#header-content"><i class="fa fa-check"></i><b>4.1</b> Header content</a></li>
<li class="chapter" data-level="4.2" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#settings-and-setup"><i class="fa fa-check"></i><b>4.2</b> Settings and setup</a></li>
<li class="chapter" data-level="4.3" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#importing-data-1"><i class="fa fa-check"></i><b>4.3</b> Importing data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#factors"><i class="fa fa-check"></i><b>4.3.1</b> Factors</a></li>
<li class="chapter" data-level="4.3.2" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#modifying-the-epi-year"><i class="fa fa-check"></i><b>4.3.2</b> Modifying the epi year</a></li>
<li class="chapter" data-level="4.3.3" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#reading-the-files"><i class="fa fa-check"></i><b>4.3.3</b> Reading the files</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#highlights-slide"><i class="fa fa-check"></i><b>4.4</b> Highlights slide</a></li>
<li class="chapter" data-level="4.5" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#graphing"><i class="fa fa-check"></i><b>4.5</b> Graphing</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#ili-counts-by-week"><i class="fa fa-check"></i><b>4.5.1</b> ILI counts by week</a></li>
<li class="chapter" data-level="4.5.2" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#ili-counts-by-age-group"><i class="fa fa-check"></i><b>4.5.2</b> ILI counts by age group</a></li>
<li class="chapter" data-level="4.5.3" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#ili-proportions-by-age-group"><i class="fa fa-check"></i><b>4.5.3</b> ILI proportions by age group</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#rendering-and-formatting"><i class="fa fa-check"></i><b>4.6</b> Rendering and formatting</a></li>
<li class="chapter" data-level="4.7" data-path="respiratory-viruses.html"><a href="respiratory-viruses.html#final-notes-3"><i class="fa fa-check"></i><b>4.7</b> Final notes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bookdown.html"><a href="bookdown.html"><i class="fa fa-check"></i><b>5</b> Bookdown</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bookdown.html"><a href="bookdown.html#file-structure"><i class="fa fa-check"></i><b>5.1</b> File structure</a></li>
<li class="chapter" data-level="5.2" data-path="bookdown.html"><a href="bookdown.html#bookdown-package"><i class="fa fa-check"></i><b>5.2</b> Bookdown package</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Created with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">In-Service Presentation, August 2024</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="respiratory-viruses" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Section 4</span> Respiratory Viruses<a href="respiratory-viruses.html#respiratory-viruses" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The Epidemiology Program at WCHHS, during flu season, publishes a bi-weekly update on respiratory viruses using data from the North Carolina Disease Event Tracking and Epidemiologic Collection Tool (NC DETECT), which collects emergency department case data and classifies reported syndromes. Three conditions are pulled from NC DETECT: influenza-like illness (ILI), COVID-like illness (CLI), and respiratory syncytial virus (RSV). Emergency department data can provide insight into community levels of disease, and it is particularly useful when other means of reporting are unavailable or inconsistent.</p>
<p>This section walks through the process of automating the production of these bi-weekly reports in R. This process uses Quarto, which is an advanced implementation of RMarkdown, to generate a PowerPoint presentation. From within RStudio, R code can be executed, graphics can be rendered, and text can be written. Once Quarto (in RStudio) renders the presentation, the .pptx file can be manually edited, and a standard theme (such as Wake County’s preferred slide theme) can be applied in PowerPoint.</p>
<p>If you are only looking for instructions on how to automatically generate the presentation, skip to <a href="respiratory-viruses.html#rendering-and-formatting">rendering and formatting</a>.</p>
<div id="header-content" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Header content<a href="respiratory-viruses.html#header-content" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Unlike previous projects in this presentation, where the format was essentially just a vehicle for delivery, the presentation format is essential to the project. Instead of libraries, then, we will start at the top: the RMarkdown header.</p>
<pre><code>---
title: &quot;Influenza, RSV and COVID-19 Bi-Weekly Update&quot;
author: &quot;Wake County Health and Human Services&quot;
format: pptx
---</code></pre>
<p>The header includes three elements:</p>
<ol style="list-style-type: decimal">
<li>The title of the presentation, which will go on the title slide.</li>
<li>The author of the presentation, which will go beneath the title.</li>
<li>The presentation format, which should be pptx unless you are familiar with another supported format.</li>
</ol>
<p>We do not need to create a separate title slide below the header because the header will be used to generate the title slide.</p>
</div>
<div id="settings-and-setup" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Settings and setup<a href="respiratory-viruses.html#settings-and-setup" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Because this presentation’s code is intended to be infinitely reusable, a settings chunk is included at the top, where instructions are included for setting the dates of interest.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="respiratory-viruses.html#cb61-1" tabindex="-1"></a><span class="do">## Dates of interest: The MMWR Week range, in the current year,</span></span>
<span id="cb61-2"><a href="respiratory-viruses.html#cb61-2" tabindex="-1"></a><span class="do">## which you want to graph. Use year-month-day format.</span></span>
<span id="cb61-3"><a href="respiratory-viruses.html#cb61-3" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="st">&quot;2024-05-05&quot;</span></span>
<span id="cb61-4"><a href="respiratory-viruses.html#cb61-4" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="st">&quot;2024-06-01&quot;</span></span>
<span id="cb61-5"><a href="respiratory-viruses.html#cb61-5" tabindex="-1"></a></span>
<span id="cb61-6"><a href="respiratory-viruses.html#cb61-6" tabindex="-1"></a><span class="do">## Comparison dates: The MMWR Week range, in the prior year,</span></span>
<span id="cb61-7"><a href="respiratory-viruses.html#cb61-7" tabindex="-1"></a><span class="do">## which you want to graph. Use year-month-day format.</span></span>
<span id="cb61-8"><a href="respiratory-viruses.html#cb61-8" tabindex="-1"></a>start_date_ly <span class="ot">&lt;-</span> <span class="st">&quot;2023-05-07&quot;</span></span>
<span id="cb61-9"><a href="respiratory-viruses.html#cb61-9" tabindex="-1"></a>end_date_ly <span class="ot">&lt;-</span> <span class="st">&quot;2023-05-28&quot;</span></span></code></pre></div>
<p>In this section, we set (in year-month-day format) the start and end dates for analysis. Dates for both the current year and the prior (comparison) year must be included, since weeks do not start on the same date. When all of these dates are Sundays, the code treats <code>start_date</code> and <code>start_date_ly</code> as the first dates for analysis, and it treats <code>end_date</code> and <code>end_date_ly</code> as the <em>first day of the last week</em> to be included in the analysis. Choosing any day except Sunday for the end dates will select the week they are in, so choosing Saturday as your end date will work as expected.</p>
<p>Before running the presentation, files also need to be dropped into the folder. NC DETECT allows for line list exports, and these line lists are used for the presentation. Three files, named CLI.xlsx, ILI.xlsx, and RSV.xlsx, need to be added to the Automation folder, and they should include all cases between your chosen <code>start_date_ly</code> and your <code>end_date</code>. We’ll see later how the code filters out the cases between <code>end_date_ly</code> and <code>start_date</code> so they don’t interfere with the graphs.</p>
<p>Once we’ve set the dates and are ready to continue running the presentation, the code will format the dates. We will also need to load the libraries.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="respiratory-viruses.html#cb62-1" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb62-2"><a href="respiratory-viruses.html#cb62-2" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(tidyverse))</span>
<span id="cb62-3"><a href="respiratory-viruses.html#cb62-3" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(readxl))</span>
<span id="cb62-4"><a href="respiratory-viruses.html#cb62-4" tabindex="-1"></a></span>
<span id="cb62-5"><a href="respiratory-viruses.html#cb62-5" tabindex="-1"></a><span class="co"># Date formatting</span></span>
<span id="cb62-6"><a href="respiratory-viruses.html#cb62-6" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(start_date)</span>
<span id="cb62-7"><a href="respiratory-viruses.html#cb62-7" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(end_date)</span>
<span id="cb62-8"><a href="respiratory-viruses.html#cb62-8" tabindex="-1"></a>start_date_ly <span class="ot">&lt;-</span> <span class="fu">ymd</span>(start_date_ly)</span>
<span id="cb62-9"><a href="respiratory-viruses.html#cb62-9" tabindex="-1"></a>end_date_ly <span class="ot">&lt;-</span> <span class="fu">ymd</span>(end_date_ly)</span></code></pre></div>
<p>As we have previously, we use <code>tidyverse</code> and <code>readxl</code>. One <code>tidyverse</code> package, called <code>lubridate</code>, will be helpful here as we format dates: the <code>ymd()</code> function informs R that the dates we chose before are dates in year-month-day format.</p>
</div>
<div id="importing-data-1" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Importing data<a href="respiratory-viruses.html#importing-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next, we write a function to read and modify the NC DETECT data. This is a long one, and several <code>mutate</code> steps are used here to make sure the variables are modified and read in a useful order. Also note the use of <code>%&gt;%</code> (pipe) characters to order this function. Without piping, the functions would have to be nested with the last function on the outside, which would make this code practically unreadable.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="respiratory-viruses.html#cb63-1" tabindex="-1"></a><span class="co"># Assign to `sesh_import` a function with one argument (x) and the following code</span></span>
<span id="cb63-2"><a href="respiratory-viruses.html#cb63-2" tabindex="-1"></a>sesh_import <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb63-3"><a href="respiratory-viruses.html#cb63-3" tabindex="-1"></a>  </span>
<span id="cb63-4"><a href="respiratory-viruses.html#cb63-4" tabindex="-1"></a>  <span class="co"># Begin with the data, given to the function as an argument</span></span>
<span id="cb63-5"><a href="respiratory-viruses.html#cb63-5" tabindex="-1"></a>  x <span class="sc">%&gt;%</span> </span>
<span id="cb63-6"><a href="respiratory-viruses.html#cb63-6" tabindex="-1"></a>    </span>
<span id="cb63-7"><a href="respiratory-viruses.html#cb63-7" tabindex="-1"></a>    <span class="co"># Mutate variables</span></span>
<span id="cb63-8"><a href="respiratory-viruses.html#cb63-8" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb63-9"><a href="respiratory-viruses.html#cb63-9" tabindex="-1"></a>      </span>
<span id="cb63-10"><a href="respiratory-viruses.html#cb63-10" tabindex="-1"></a>      <span class="co"># Modify three variables from character type to date-time (year-month-day, hour-minute-second) type</span></span>
<span id="cb63-11"><a href="respiratory-viruses.html#cb63-11" tabindex="-1"></a>      <span class="st">&quot;Arrival Date Time&quot;</span> <span class="ot">=</span> <span class="fu">ymd_hms</span>(<span class="st">`</span><span class="at">Arrival Date Time</span><span class="st">`</span>),</span>
<span id="cb63-12"><a href="respiratory-viruses.html#cb63-12" tabindex="-1"></a>      <span class="st">&quot;(beta) ED Discharge DT&quot;</span> <span class="ot">=</span> <span class="fu">ymd_hms</span>(<span class="st">`</span><span class="at">(beta) ED Discharge DT</span><span class="st">`</span>),</span>
<span id="cb63-13"><a href="respiratory-viruses.html#cb63-13" tabindex="-1"></a>      <span class="st">&quot;(beta) Hospital Discharge DT&quot;</span> <span class="ot">=</span> <span class="fu">ymd_hms</span>(<span class="st">`</span><span class="at">(beta) Hospital Discharge DT</span><span class="st">`</span>)</span>
<span id="cb63-14"><a href="respiratory-viruses.html#cb63-14" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb63-15"><a href="respiratory-viruses.html#cb63-15" tabindex="-1"></a>    </span>
<span id="cb63-16"><a href="respiratory-viruses.html#cb63-16" tabindex="-1"></a>    <span class="co"># Mutate more variables</span></span>
<span id="cb63-17"><a href="respiratory-viruses.html#cb63-17" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb63-18"><a href="respiratory-viruses.html#cb63-18" tabindex="-1"></a>      </span>
<span id="cb63-19"><a href="respiratory-viruses.html#cb63-19" tabindex="-1"></a>      <span class="co"># Create `Arrival`, which takes just the date information from `Arrival Date Time`</span></span>
<span id="cb63-20"><a href="respiratory-viruses.html#cb63-20" tabindex="-1"></a>      <span class="st">&quot;Arrival&quot;</span> <span class="ot">=</span> <span class="fu">as_date</span>(<span class="st">`</span><span class="at">Arrival Date Time</span><span class="st">`</span>),</span>
<span id="cb63-21"><a href="respiratory-viruses.html#cb63-21" tabindex="-1"></a>      </span>
<span id="cb63-22"><a href="respiratory-viruses.html#cb63-22" tabindex="-1"></a>      <span class="co"># Calculate the epi week, starting on Sunday, when the case occurred</span></span>
<span id="cb63-23"><a href="respiratory-viruses.html#cb63-23" tabindex="-1"></a>      <span class="st">&quot;MMWR Week&quot;</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb63-24"><a href="respiratory-viruses.html#cb63-24" tabindex="-1"></a>        <span class="fu">wday</span>(Arrival) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> Arrival, <span class="co"># If the arrival day was Sunday, use that day</span></span>
<span id="cb63-25"><a href="respiratory-viruses.html#cb63-25" tabindex="-1"></a>        <span class="fu">wday</span>(Arrival) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span>                  <span class="co"># If the arrival day was not Sunday...</span></span>
<span id="cb63-26"><a href="respiratory-viruses.html#cb63-26" tabindex="-1"></a>          Arrival <span class="sc">-</span> <span class="fu">days</span>(<span class="fu">wday</span>(Arrival)) <span class="sc">+</span> <span class="dv">1</span>, <span class="co"># ...determine the most recent Sunday</span></span>
<span id="cb63-27"><a href="respiratory-viruses.html#cb63-27" tabindex="-1"></a>        <span class="at">.default =</span> <span class="cn">NA</span> <span class="co"># If there is no arrival date, return NA</span></span>
<span id="cb63-28"><a href="respiratory-viruses.html#cb63-28" tabindex="-1"></a>      ),</span>
<span id="cb63-29"><a href="respiratory-viruses.html#cb63-29" tabindex="-1"></a>      </span>
<span id="cb63-30"><a href="respiratory-viruses.html#cb63-30" tabindex="-1"></a>      <span class="co"># Calculate the epi year</span></span>
<span id="cb63-31"><a href="respiratory-viruses.html#cb63-31" tabindex="-1"></a>      <span class="st">&quot;MMWR Year&quot;</span> <span class="ot">=</span> <span class="fu">year</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>),</span>
<span id="cb63-32"><a href="respiratory-viruses.html#cb63-32" tabindex="-1"></a>      </span>
<span id="cb63-33"><a href="respiratory-viruses.html#cb63-33" tabindex="-1"></a>      <span class="co"># Delete the arrival date time variable (it&#39;s not very useful)</span></span>
<span id="cb63-34"><a href="respiratory-viruses.html#cb63-34" tabindex="-1"></a>      <span class="st">&quot;Arrival Date Time&quot;</span> <span class="ot">=</span> <span class="cn">NULL</span>,</span>
<span id="cb63-35"><a href="respiratory-viruses.html#cb63-35" tabindex="-1"></a>      </span>
<span id="cb63-36"><a href="respiratory-viruses.html#cb63-36" tabindex="-1"></a>      <span class="co"># Put these variables at the beginning (before column 1)</span></span>
<span id="cb63-37"><a href="respiratory-viruses.html#cb63-37" tabindex="-1"></a>      <span class="at">.before =</span> <span class="dv">1</span></span>
<span id="cb63-38"><a href="respiratory-viruses.html#cb63-38" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb63-39"><a href="respiratory-viruses.html#cb63-39" tabindex="-1"></a>    </span>
<span id="cb63-40"><a href="respiratory-viruses.html#cb63-40" tabindex="-1"></a>    <span class="co"># Mutate more variables</span></span>
<span id="cb63-41"><a href="respiratory-viruses.html#cb63-41" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb63-42"><a href="respiratory-viruses.html#cb63-42" tabindex="-1"></a>      </span>
<span id="cb63-43"><a href="respiratory-viruses.html#cb63-43" tabindex="-1"></a>      <span class="co"># Make `Patient Age` a numeric (not character) variable</span></span>
<span id="cb63-44"><a href="respiratory-viruses.html#cb63-44" tabindex="-1"></a>      <span class="st">`</span><span class="at">Patient Age</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Patient Age</span><span class="st">`</span>),</span>
<span id="cb63-45"><a href="respiratory-viruses.html#cb63-45" tabindex="-1"></a>      </span>
<span id="cb63-46"><a href="respiratory-viruses.html#cb63-46" tabindex="-1"></a>      <span class="co"># Make `Patient Age Group` an ordered variable (factor)</span></span>
<span id="cb63-47"><a href="respiratory-viruses.html#cb63-47" tabindex="-1"></a>      <span class="st">`</span><span class="at">Patient Age Group</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(</span>
<span id="cb63-48"><a href="respiratory-viruses.html#cb63-48" tabindex="-1"></a>        <span class="co"># Keep the same values as the original dataset&#39;s (.) variable ($`Patient Age Group`)</span></span>
<span id="cb63-49"><a href="respiratory-viruses.html#cb63-49" tabindex="-1"></a>        <span class="at">x =</span> .<span class="sc">$</span><span class="st">`</span><span class="at">Patient Age Group</span><span class="st">`</span>,</span>
<span id="cb63-50"><a href="respiratory-viruses.html#cb63-50" tabindex="-1"></a>        <span class="co"># Make the variable ordinal, and order its values this way</span></span>
<span id="cb63-51"><a href="respiratory-viruses.html#cb63-51" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Infant (0 - 1)&quot;</span>, <span class="st">&quot;PreSchool (2 - 4)&quot;</span>,</span>
<span id="cb63-52"><a href="respiratory-viruses.html#cb63-52" tabindex="-1"></a>                   <span class="st">&quot;Elem. School (5 - 9)&quot;</span>, <span class="st">&quot;Middle School (10 - 14)&quot;</span>,</span>
<span id="cb63-53"><a href="respiratory-viruses.html#cb63-53" tabindex="-1"></a>                   <span class="st">&quot;High School (15 - 18)&quot;</span>, <span class="st">&quot;College (19 - 24)&quot;</span>,</span>
<span id="cb63-54"><a href="respiratory-viruses.html#cb63-54" tabindex="-1"></a>                   <span class="st">&quot;Young Adult (25 - 44)&quot;</span>, <span class="st">&quot;Middle Aged (45 - 64)&quot;</span>,</span>
<span id="cb63-55"><a href="respiratory-viruses.html#cb63-55" tabindex="-1"></a>                   <span class="st">&quot;Senior (65+)&quot;</span>)</span>
<span id="cb63-56"><a href="respiratory-viruses.html#cb63-56" tabindex="-1"></a>      ),</span>
<span id="cb63-57"><a href="respiratory-viruses.html#cb63-57" tabindex="-1"></a>      </span>
<span id="cb63-58"><a href="respiratory-viruses.html#cb63-58" tabindex="-1"></a>      <span class="co"># Make two more variables numeric - this will throw an error if data is unclean</span></span>
<span id="cb63-59"><a href="respiratory-viruses.html#cb63-59" tabindex="-1"></a>      <span class="st">`</span><span class="at">Patient ZIP</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Patient ZIP</span><span class="st">`</span>),</span>
<span id="cb63-60"><a href="respiratory-viruses.html#cb63-60" tabindex="-1"></a>      <span class="st">`</span><span class="at">Init Temp</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Init Temp</span><span class="st">`</span>),</span>
<span id="cb63-61"><a href="respiratory-viruses.html#cb63-61" tabindex="-1"></a>      </span>
<span id="cb63-62"><a href="respiratory-viruses.html#cb63-62" tabindex="-1"></a>      <span class="co"># Make Race and Ethnicity factors as well</span></span>
<span id="cb63-63"><a href="respiratory-viruses.html#cb63-63" tabindex="-1"></a>      <span class="at">Race =</span> <span class="fu">factor</span>(</span>
<span id="cb63-64"><a href="respiratory-viruses.html#cb63-64" tabindex="-1"></a>        <span class="at">x =</span> .<span class="sc">$</span>Race,</span>
<span id="cb63-65"><a href="respiratory-viruses.html#cb63-65" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Asian&quot;</span>, <span class="st">&quot;Black&quot;</span>, <span class="st">&quot;White&quot;</span>, <span class="st">&quot;Other&quot;</span>)</span>
<span id="cb63-66"><a href="respiratory-viruses.html#cb63-66" tabindex="-1"></a>      ),</span>
<span id="cb63-67"><a href="respiratory-viruses.html#cb63-67" tabindex="-1"></a>      <span class="at">Ethnicity =</span> <span class="fu">factor</span>(</span>
<span id="cb63-68"><a href="respiratory-viruses.html#cb63-68" tabindex="-1"></a>        <span class="at">x =</span> .<span class="sc">$</span>Ethnicity,</span>
<span id="cb63-69"><a href="respiratory-viruses.html#cb63-69" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Hispanic&quot;</span>, <span class="st">&quot;Not of Hispanic Origin&quot;</span>, <span class="st">&quot;Unknown&quot;</span>)</span>
<span id="cb63-70"><a href="respiratory-viruses.html#cb63-70" tabindex="-1"></a>      )</span>
<span id="cb63-71"><a href="respiratory-viruses.html#cb63-71" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb63-72"><a href="respiratory-viruses.html#cb63-72" tabindex="-1"></a>    </span>
<span id="cb63-73"><a href="respiratory-viruses.html#cb63-73" tabindex="-1"></a>    <span class="co"># Create an age group variable using `Patient Age` and order it</span></span>
<span id="cb63-74"><a href="respiratory-viruses.html#cb63-74" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Age Group</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(</span>
<span id="cb63-75"><a href="respiratory-viruses.html#cb63-75" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">case_when</span>(</span>
<span id="cb63-76"><a href="respiratory-viruses.html#cb63-76" tabindex="-1"></a>        <span class="st">`</span><span class="at">Patient Age</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">&quot;(00 - 04) Infant/Toddler&quot;</span>,</span>
<span id="cb63-77"><a href="respiratory-viruses.html#cb63-77" tabindex="-1"></a>        <span class="st">`</span><span class="at">Patient Age</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Patient Age</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">17</span> <span class="sc">~</span> <span class="st">&quot;(05 - 17) School-Age&quot;</span>,</span>
<span id="cb63-78"><a href="respiratory-viruses.html#cb63-78" tabindex="-1"></a>        <span class="st">`</span><span class="at">Patient Age</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Patient Age</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">24</span> <span class="sc">~</span> <span class="st">&quot;(18 - 24) College&quot;</span>,</span>
<span id="cb63-79"><a href="respiratory-viruses.html#cb63-79" tabindex="-1"></a>        <span class="st">`</span><span class="at">Patient Age</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">25</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Patient Age</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">49</span> <span class="sc">~</span> <span class="st">&quot;(25 - 49) Young Adult&quot;</span>,</span>
<span id="cb63-80"><a href="respiratory-viruses.html#cb63-80" tabindex="-1"></a>        <span class="st">`</span><span class="at">Patient Age</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Patient Age</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">64</span> <span class="sc">~</span> <span class="st">&quot;(50 - 64) Middle Aged&quot;</span>,</span>
<span id="cb63-81"><a href="respiratory-viruses.html#cb63-81" tabindex="-1"></a>        <span class="st">`</span><span class="at">Patient Age</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">65</span> <span class="sc">~</span> <span class="st">&quot;(65+) Senior&quot;</span>,</span>
<span id="cb63-82"><a href="respiratory-viruses.html#cb63-82" tabindex="-1"></a>        <span class="at">.default =</span> <span class="st">&quot;Unknown/Missing&quot;</span></span>
<span id="cb63-83"><a href="respiratory-viruses.html#cb63-83" tabindex="-1"></a>      ),</span>
<span id="cb63-84"><a href="respiratory-viruses.html#cb63-84" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;(00 - 04) Infant/Toddler&quot;</span>, <span class="st">&quot;(05 - 17) School-Age&quot;</span>, <span class="st">&quot;(18 - 24) College&quot;</span>,</span>
<span id="cb63-85"><a href="respiratory-viruses.html#cb63-85" tabindex="-1"></a>                 <span class="st">&quot;(25 - 49) Young Adult&quot;</span>, <span class="st">&quot;(50 - 64) Middle Aged&quot;</span>, <span class="st">&quot;(65+) Senior&quot;</span>,</span>
<span id="cb63-86"><a href="respiratory-viruses.html#cb63-86" tabindex="-1"></a>                 <span class="st">&quot;Unknown/Missing&quot;</span>)</span>
<span id="cb63-87"><a href="respiratory-viruses.html#cb63-87" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb63-88"><a href="respiratory-viruses.html#cb63-88" tabindex="-1"></a>    </span>
<span id="cb63-89"><a href="respiratory-viruses.html#cb63-89" tabindex="-1"></a>    <span class="co"># Filter out data that isn&#39;t in the specified epi week range</span></span>
<span id="cb63-90"><a href="respiratory-viruses.html#cb63-90" tabindex="-1"></a>    <span class="fu">filter</span>((<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span> <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> <span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span> <span class="sc">&lt;=</span> end_date) <span class="sc">|</span></span>
<span id="cb63-91"><a href="respiratory-viruses.html#cb63-91" tabindex="-1"></a>             (<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span> <span class="sc">&gt;=</span> start_date_ly <span class="sc">&amp;</span> <span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span> <span class="sc">&lt;=</span> end_date_ly)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-92"><a href="respiratory-viruses.html#cb63-92" tabindex="-1"></a>    </span>
<span id="cb63-93"><a href="respiratory-viruses.html#cb63-93" tabindex="-1"></a>    <span class="co"># Modify epi year values to keep seasons together (see note)</span></span>
<span id="cb63-94"><a href="respiratory-viruses.html#cb63-94" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb63-95"><a href="respiratory-viruses.html#cb63-95" tabindex="-1"></a>      <span class="st">&quot;modified&quot;</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb63-96"><a href="respiratory-viruses.html#cb63-96" tabindex="-1"></a>        <span class="fu">year</span>(end_date) <span class="sc">-</span> <span class="fu">year</span>(start_date) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb63-97"><a href="respiratory-viruses.html#cb63-97" tabindex="-1"></a>          <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>, <span class="st">&quot;-08-|-09-|-10-|-11-|-12-&quot;</span>) <span class="sc">~</span> <span class="cn">TRUE</span>,</span>
<span id="cb63-98"><a href="respiratory-viruses.html#cb63-98" tabindex="-1"></a>        <span class="at">.default =</span> <span class="cn">FALSE</span></span>
<span id="cb63-99"><a href="respiratory-viruses.html#cb63-99" tabindex="-1"></a>      ),</span>
<span id="cb63-100"><a href="respiratory-viruses.html#cb63-100" tabindex="-1"></a>      <span class="st">&quot;MMWR Year&quot;</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb63-101"><a href="respiratory-viruses.html#cb63-101" tabindex="-1"></a>        <span class="fu">year</span>(end_date) <span class="sc">-</span> <span class="fu">year</span>(start_date) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb63-102"><a href="respiratory-viruses.html#cb63-102" tabindex="-1"></a>          <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>, <span class="st">&quot;-08-|-09-|-10-|-11-|-12-&quot;</span>) <span class="sc">~</span> <span class="st">`</span><span class="at">MMWR Year</span><span class="st">`</span> <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb63-103"><a href="respiratory-viruses.html#cb63-103" tabindex="-1"></a>        <span class="at">.default =</span> <span class="st">`</span><span class="at">MMWR Year</span><span class="st">`</span></span>
<span id="cb63-104"><a href="respiratory-viruses.html#cb63-104" tabindex="-1"></a>      )</span>
<span id="cb63-105"><a href="respiratory-viruses.html#cb63-105" tabindex="-1"></a>    )</span>
<span id="cb63-106"><a href="respiratory-viruses.html#cb63-106" tabindex="-1"></a>}</span></code></pre></div>
<p>There is a lot here! There are two main things that need more explanation than the code comments: factors and modifying epi year values.</p>
<div id="factors" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Factors<a href="respiratory-viruses.html#factors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Factors</em> are ordered categorical variables. We use them when we have a variable with text values that have an inherent (non-alphabetical) order. A good example is <code>Patient Age Group</code>: if we left it as a regular character variable, it would be ordered like this:</p>
<pre><code>## [1] &quot;College (19 - 24)&quot;       &quot;Elem. School (5 - 9)&quot;    &quot;High School (15 - 18)&quot;  
## [4] &quot;Infant (0 - 1)&quot;          &quot;Middle Aged (45 - 64)&quot;   &quot;Middle School (10 - 14)&quot;
## [7] &quot;PreSchool (2 - 4)&quot;       &quot;Senior (65+)&quot;            &quot;Young Adult (25 - 44)&quot;</code></pre>
<p>But we don’t want them to be alphabetical, because that doesn’t make sense for the data. A factor allows us to take data (given in the <code>x</code> argument) and order it according to a list or vector we create (given in the <code>levels</code> argument). If you are familiar with SAS, this is very similar to coding variables as numeric and using <code>PROC FORMAT</code> to cover the underlying number, except that R never requires you to remember or use the number directly.</p>
</div>
<div id="modifying-the-epi-year" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Modifying the epi year<a href="respiratory-viruses.html#modifying-the-epi-year" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Because flu season runs from fall to spring, our line graphs need to span the gap between December and January. The best way to do this is to tweak the epi year, so that (as an example) the 2023-2024 season will appear on the graph as a continuous line for 2024. We only need this feature to activate when the following conditions are met:</p>
<ol style="list-style-type: decimal">
<li><code>start_date</code> and <code>end_date</code> are in different years.</li>
<li>The case occurred in or after August, which will always catch the beginning of fall.</li>
</ol>
<p>We can evaluate the first condition by just subtracting the years. For the second condition, we use <code>str_detect</code> to check the month, which will always be between the two dashes in year-month-day format. If these conditions are met, we adjust the year up by one to keep the lines continuous, and we also set a new <code>modified</code> variable to <code>TRUE</code> so we know this case was affected.</p>
<p>More work is needed to solve this problem, which we’ll see in the graphing code later.</p>
</div>
<div id="reading-the-files" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Reading the files<a href="respiratory-viruses.html#reading-the-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, we actually read the files using the function we created above.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="respiratory-viruses.html#cb65-1" tabindex="-1"></a><span class="co"># Read files</span></span>
<span id="cb65-2"><a href="respiratory-viruses.html#cb65-2" tabindex="-1"></a>ILI <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;ILI.xlsx&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="respiratory-viruses.html#cb65-3" tabindex="-1"></a>  <span class="fu">sesh_import</span>()</span>
<span id="cb65-4"><a href="respiratory-viruses.html#cb65-4" tabindex="-1"></a>RSV <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;RSV.xlsx&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-5"><a href="respiratory-viruses.html#cb65-5" tabindex="-1"></a>  <span class="fu">sesh_import</span>()</span>
<span id="cb65-6"><a href="respiratory-viruses.html#cb65-6" tabindex="-1"></a>CLI <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;CLI.xlsx&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-7"><a href="respiratory-viruses.html#cb65-7" tabindex="-1"></a>  <span class="fu">sesh_import</span>()</span></code></pre></div>
<p>We use <code>read_xlsx</code> from the <code>readxl</code> package to read each file and pipe the data into <code>sesh_import</code> above. Now, our data is imported.</p>
</div>
</div>
<div id="highlights-slide" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Highlights slide<a href="respiratory-viruses.html#highlights-slide" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For the presentation, all code is invisible, because the R code chunks in our Quarto document include the option <code>echo = FALSE</code> (unlike <em>this</em> presentation, where we want to see the code). Because code is invisible, everything between the header and now is performed, but it isn’t displayed on the slides. However, we do want to show some content.</p>
<p>We want to create a Highlights slide, where an epidemiologist can include main takeaways from the data collected for the presentation. We want space for content to be added to the PowerPoint after it’s generated, but nothing here needs to be run in R, so we can just use plain text in Markdown syntax.</p>
<pre><code># Highlights

-   Influenza Like Illness (ILI)
    -   Content here
-   Respiratory Syncytial Virus (RSV)
    -   Content here
-   COVID-19
    -   Content here</code></pre>
<p>The <code>#</code> creates a first-level heading, which in the context of a presentation becomes the title of a new slide. If we wanted subheadings, we could use <code>##</code>. Then, we use <code>-</code> and indentations to create unordered bullets and sub-bullets. Content can be edited on the .qmd document, but it is probably more useful and efficient in this case to do it directly on the PowerPoint after rendering.</p>
<p><a href="https://rstudio.github.io/cheatsheets/html/rmarkdown.html">RMarkdown syntax</a> is very powerful, and very little of it is used for this specific presentation, so see the website for details. You can also see the Resources and Preventive Measures sections of the Quarto presentation document for more examples.</p>
</div>
<div id="graphing" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Graphing<a href="respiratory-viruses.html#graphing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, we can start to graph the data we’ve pulled. I’ll include only the code and graphs for influenza-like illness here, because each disease’s graphs work the same way, but the .qmd file on the SharePoint generates graphs for ILI, RSV, and CLI.</p>
<p>For graphing, as elsewhere in this presentation, we use <code>ggplot2</code> from the tidyverse.</p>
<div id="ili-counts-by-week" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> ILI counts by week<a href="respiratory-viruses.html#ili-counts-by-week" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To create this graph, we need to do a few things:</p>
<ol style="list-style-type: decimal">
<li>Select the <code>ILI</code> data.</li>
<li>Extract just the month and day from the epi week fields to save space. Additionally, when the graph would straddle January 1 of any year, modify dates before January 1 so they appear to the left of dates after January 1.</li>
<li>Group cases by epi week and year, then count cases in each group.</li>
<li>Plot a line graph with two lines, one for each year, showing the counts.</li>
</ol>
<p>We complete those steps with this code:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="respiratory-viruses.html#cb67-1" tabindex="-1"></a><span class="co"># 1. Select the `ILI` data</span></span>
<span id="cb67-2"><a href="respiratory-viruses.html#cb67-2" tabindex="-1"></a>ILI <span class="sc">%&gt;%</span> </span>
<span id="cb67-3"><a href="respiratory-viruses.html#cb67-3" tabindex="-1"></a>  </span>
<span id="cb67-4"><a href="respiratory-viruses.html#cb67-4" tabindex="-1"></a>  <span class="co"># 2. Extract just the month and day from `MMWR Week`</span></span>
<span id="cb67-5"><a href="respiratory-viruses.html#cb67-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb67-6"><a href="respiratory-viruses.html#cb67-6" tabindex="-1"></a>    <span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb67-7"><a href="respiratory-viruses.html#cb67-7" tabindex="-1"></a>      modified <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">~</span> <span class="fu">paste</span>(</span>
<span id="cb67-8"><a href="respiratory-viruses.html#cb67-8" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">month</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>)),</span>
<span id="cb67-9"><a href="respiratory-viruses.html#cb67-9" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">day</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>)), <span class="at">sep=</span><span class="st">&quot;-&quot;</span></span>
<span id="cb67-10"><a href="respiratory-viruses.html#cb67-10" tabindex="-1"></a>        ),</span>
<span id="cb67-11"><a href="respiratory-viruses.html#cb67-11" tabindex="-1"></a>      <span class="co"># 2a. Modify dates before 1/1 to appear to the left</span></span>
<span id="cb67-12"><a href="respiratory-viruses.html#cb67-12" tabindex="-1"></a>      modified <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste</span>(</span>
<span id="cb67-13"><a href="respiratory-viruses.html#cb67-13" tabindex="-1"></a>        <span class="st">&quot;&quot;</span>,</span>
<span id="cb67-14"><a href="respiratory-viruses.html#cb67-14" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">month</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>)),</span>
<span id="cb67-15"><a href="respiratory-viruses.html#cb67-15" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">day</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>)), <span class="at">sep=</span><span class="st">&quot;-&quot;</span></span>
<span id="cb67-16"><a href="respiratory-viruses.html#cb67-16" tabindex="-1"></a>        )</span>
<span id="cb67-17"><a href="respiratory-viruses.html#cb67-17" tabindex="-1"></a>      ),</span>
<span id="cb67-18"><a href="respiratory-viruses.html#cb67-18" tabindex="-1"></a>    <span class="do">## Modify the year to be discrete rather than continuous (for display purposes)</span></span>
<span id="cb67-19"><a href="respiratory-viruses.html#cb67-19" tabindex="-1"></a>    <span class="st">`</span><span class="at">MMWR Year</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">MMWR Year</span><span class="st">`</span>)</span>
<span id="cb67-20"><a href="respiratory-viruses.html#cb67-20" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb67-21"><a href="respiratory-viruses.html#cb67-21" tabindex="-1"></a>  </span>
<span id="cb67-22"><a href="respiratory-viruses.html#cb67-22" tabindex="-1"></a>  <span class="co"># 3. Group cases by epi week and year, then tally cases</span></span>
<span id="cb67-23"><a href="respiratory-viruses.html#cb67-23" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">MMWR Year</span><span class="st">`</span>, <span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb67-24"><a href="respiratory-viruses.html#cb67-24" tabindex="-1"></a>  <span class="fu">tally</span>(<span class="at">name =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-25"><a href="respiratory-viruses.html#cb67-25" tabindex="-1"></a>  </span>
<span id="cb67-26"><a href="respiratory-viruses.html#cb67-26" tabindex="-1"></a>  <span class="co"># 4. Plot a line graph</span></span>
<span id="cb67-27"><a href="respiratory-viruses.html#cb67-27" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>, <span class="at">y =</span> Count, <span class="at">color =</span> <span class="st">`</span><span class="at">MMWR Year</span><span class="st">`</span>,</span>
<span id="cb67-28"><a href="respiratory-viruses.html#cb67-28" tabindex="-1"></a>             <span class="at">group =</span> <span class="st">`</span><span class="at">MMWR Year</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb67-29"><a href="respiratory-viruses.html#cb67-29" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb67-30"><a href="respiratory-viruses.html#cb67-30" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb67-31"><a href="respiratory-viruses.html#cb67-31" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb67-32"><a href="respiratory-viruses.html#cb67-32" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Week&quot;</span>,</span>
<span id="cb67-33"><a href="respiratory-viruses.html#cb67-33" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Year&quot;</span></span>
<span id="cb67-34"><a href="respiratory-viruses.html#cb67-34" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb67-35"><a href="respiratory-viruses.html#cb67-35" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb67-36"><a href="respiratory-viruses.html#cb67-36" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb67-37"><a href="respiratory-viruses.html#cb67-37" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ILI Counts by Week&quot;</span>) <span class="sc">+</span></span>
<span id="cb67-38"><a href="respiratory-viruses.html#cb67-38" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb67-39"><a href="respiratory-viruses.html#cb67-39" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb67-40"><a href="respiratory-viruses.html#cb67-40" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb67-41"><a href="respiratory-viruses.html#cb67-41" tabindex="-1"></a>  )</span></code></pre></div>
<p>We start by piping <code>ILI</code> forward to the next function. Then, there are two scenarios:</p>
<ol style="list-style-type: decimal">
<li>For cases where <code>MMWR Year</code> was not modified, we extract the month and day (using <code>sprintf()</code>, which gets and reformats variable values) from <code>MMWR Week</code>, then <code>paste()</code> them together with a dash in between.</li>
<li>For cases where <code>MMWR Year</code> <em>was</em> modified, we do the same thing, except we also add a dash in front of the month by including <code>""</code> (which is a blank string) in our <code>paste()</code> before the month. R will alphabetize the dash before numbers, so December will appear before January.</li>
</ol>
<p>In our <code>mutate()</code>, we also modify the epi year to be a character variable, which lets us deal with it as a discrete variable instead of a continuous one.</p>
<p>Next, as we’ve done for previous graphs, we group cases by their epi week and year and tally the groups, leaving us with graphable data. Finally, we plot:</p>
<ol style="list-style-type: decimal">
<li>We use <code>aes()</code> to define the variables for our x-axis, y-axis, and line coloring.</li>
<li>We choose a line graph with <code>geom_line()</code> and set its thickness (2).</li>
<li>We set the y-axis limits with <code>ylim()</code>, where we want the graph to go from 0 to ggplot’s chosen maximum, which we request with <code>NA</code>.</li>
<li>We change the x-axis and legend titles.</li>
<li>We choose our coloring scheme, in this case from RColorBrewer’s palettes.</li>
<li>We set our ggplot theme.</li>
<li>We set a plot title with <code>ggtitle()</code>.</li>
<li>We modify the legend position and the plot title alignment by changing specific <code>theme</code> elements.</li>
</ol>
<p>While the order of some of these elements is flexible, some are not. For instance, if <code>theme()</code> came before <code>theme_minimal()</code>, any settings we specified in <code>theme()</code> would be reset. When writing your own graph code, you will need to use trial and error to determine the best order for your use case.</p>
<p>That leaves us with a line graph of the counts, compared between years. Below is a sample generated for the last report of the 2023-2024 flu season.</p>
<p><img src="_main_files/figure-html/ILI%20Counts%20by%20Week%20act-1.png" width="672" /></p>
</div>
<div id="ili-counts-by-age-group" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> ILI counts by age group<a href="respiratory-viruses.html#ili-counts-by-age-group" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To graph counts by age group, we need to do a few things differently.</p>
<ol style="list-style-type: decimal">
<li>We no longer need a comparison year, so we will filter and keep only data for only the current season.</li>
<li>For grouping, we’ll substitute age group in for epi year, since we are not comparing years.</li>
<li>Because cases do not always span all demographics, we need to fill in zeroes for weeks when an age group does not have any cases.</li>
<li>When plotting, our lines will be colored according to age group rather than year.</li>
</ol>
<p>This code generates the necessary graph. Code is spaced for easier viewing, and comments are included where there are differences from the counts by year graph.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="respiratory-viruses.html#cb68-1" tabindex="-1"></a>ILI <span class="sc">%&gt;%</span> </span>
<span id="cb68-2"><a href="respiratory-viruses.html#cb68-2" tabindex="-1"></a>  </span>
<span id="cb68-3"><a href="respiratory-viruses.html#cb68-3" tabindex="-1"></a>  <span class="co"># 1. Filter and keep only current season data</span></span>
<span id="cb68-4"><a href="respiratory-viruses.html#cb68-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>) <span class="sc">==</span> <span class="fu">year</span>(start_date) <span class="sc">|</span></span>
<span id="cb68-5"><a href="respiratory-viruses.html#cb68-5" tabindex="-1"></a>           <span class="fu">year</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>) <span class="sc">==</span> <span class="fu">year</span>(end_date)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-6"><a href="respiratory-viruses.html#cb68-6" tabindex="-1"></a>  </span>
<span id="cb68-7"><a href="respiratory-viruses.html#cb68-7" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-8"><a href="respiratory-viruses.html#cb68-8" tabindex="-1"></a>    <span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb68-9"><a href="respiratory-viruses.html#cb68-9" tabindex="-1"></a>      modified <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">~</span> <span class="fu">paste</span>(</span>
<span id="cb68-10"><a href="respiratory-viruses.html#cb68-10" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">month</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>)),</span>
<span id="cb68-11"><a href="respiratory-viruses.html#cb68-11" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">day</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>)), <span class="at">sep=</span><span class="st">&quot;-&quot;</span></span>
<span id="cb68-12"><a href="respiratory-viruses.html#cb68-12" tabindex="-1"></a>        ),</span>
<span id="cb68-13"><a href="respiratory-viruses.html#cb68-13" tabindex="-1"></a>      modified <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste</span>(</span>
<span id="cb68-14"><a href="respiratory-viruses.html#cb68-14" tabindex="-1"></a>        <span class="st">&quot;&quot;</span>,</span>
<span id="cb68-15"><a href="respiratory-viruses.html#cb68-15" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">month</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>)),</span>
<span id="cb68-16"><a href="respiratory-viruses.html#cb68-16" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">day</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>)), <span class="at">sep=</span><span class="st">&quot;-&quot;</span></span>
<span id="cb68-17"><a href="respiratory-viruses.html#cb68-17" tabindex="-1"></a>        )</span>
<span id="cb68-18"><a href="respiratory-viruses.html#cb68-18" tabindex="-1"></a>      ),</span>
<span id="cb68-19"><a href="respiratory-viruses.html#cb68-19" tabindex="-1"></a>    <span class="st">`</span><span class="at">MMWR Year</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">MMWR Year</span><span class="st">`</span>)</span>
<span id="cb68-20"><a href="respiratory-viruses.html#cb68-20" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb68-21"><a href="respiratory-viruses.html#cb68-21" tabindex="-1"></a>  </span>
<span id="cb68-22"><a href="respiratory-viruses.html#cb68-22" tabindex="-1"></a>  <span class="co"># 2. Group by age and epi week</span></span>
<span id="cb68-23"><a href="respiratory-viruses.html#cb68-23" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Age Group</span><span class="st">`</span>, <span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-24"><a href="respiratory-viruses.html#cb68-24" tabindex="-1"></a>  </span>
<span id="cb68-25"><a href="respiratory-viruses.html#cb68-25" tabindex="-1"></a>  <span class="fu">tally</span>(<span class="at">name =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-26"><a href="respiratory-viruses.html#cb68-26" tabindex="-1"></a>  </span>
<span id="cb68-27"><a href="respiratory-viruses.html#cb68-27" tabindex="-1"></a>  <span class="co"># 3. Fill in zero when there are no cases in an age group for a week</span></span>
<span id="cb68-28"><a href="respiratory-viruses.html#cb68-28" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-29"><a href="respiratory-viruses.html#cb68-29" tabindex="-1"></a>  <span class="fu">complete</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>, <span class="st">`</span><span class="at">Age Group</span><span class="st">`</span>, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Count =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-30"><a href="respiratory-viruses.html#cb68-30" tabindex="-1"></a>  </span>
<span id="cb68-31"><a href="respiratory-viruses.html#cb68-31" tabindex="-1"></a>  <span class="co"># 4. Use age group to color lines</span></span>
<span id="cb68-32"><a href="respiratory-viruses.html#cb68-32" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Count</span><span class="st">`</span>,</span>
<span id="cb68-33"><a href="respiratory-viruses.html#cb68-33" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">`</span><span class="at">Age Group</span><span class="st">`</span>,</span>
<span id="cb68-34"><a href="respiratory-viruses.html#cb68-34" tabindex="-1"></a>             <span class="at">group =</span> <span class="st">`</span><span class="at">Age Group</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb68-35"><a href="respiratory-viruses.html#cb68-35" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb68-36"><a href="respiratory-viruses.html#cb68-36" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb68-37"><a href="respiratory-viruses.html#cb68-37" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Week&quot;</span>, <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb68-38"><a href="respiratory-viruses.html#cb68-38" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set3&quot;</span>) <span class="sc">+</span></span>
<span id="cb68-39"><a href="respiratory-viruses.html#cb68-39" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ILI Counts of ED Visits by Age Group&quot;</span>) <span class="sc">+</span> <span class="co"># The title is changed here</span></span>
<span id="cb68-40"><a href="respiratory-viruses.html#cb68-40" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-41"><a href="respiratory-viruses.html#cb68-41" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb68-42"><a href="respiratory-viruses.html#cb68-42" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb68-43"><a href="respiratory-viruses.html#cb68-43" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb68-44"><a href="respiratory-viruses.html#cb68-44" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>), <span class="co"># Because there are so many legend items, the size</span></span>
<span id="cb68-45"><a href="respiratory-viruses.html#cb68-45" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>) <span class="co"># of legend text is changed to fit on the graph.</span></span>
<span id="cb68-46"><a href="respiratory-viruses.html#cb68-46" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/ILI%20Counts%20by%20Age%20Group-1.png" width="672" /></p>
<p>When creating multiple graphs with the same data, it is often easier to code the first graph and make modifications rather than coding each graph from scratch. Re-using code is efficient and consistent!</p>
</div>
<div id="ili-proportions-by-age-group" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> ILI proportions by age group<a href="respiratory-viruses.html#ili-proportions-by-age-group" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the bi-weekly presentation, we also want to calculate the proportion of cases in each age group rather than just the counts. For this, we mostly recycle the counts graph code, but with a few modifications:</p>
<ol style="list-style-type: decimal">
<li>We calculate the total number of cases each week by grouping the tallies and creating a Total variable.</li>
<li>We calculate the proportion of weekly cases made up by each age group by dividing the Counts column by our new Total column.</li>
<li>When graphing, we change the y-axis from counts to proportions.</li>
</ol>
<p>This code generates the proportions graph. Again, see code comments to find where these modifications were made.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="respiratory-viruses.html#cb69-1" tabindex="-1"></a>ILI <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="respiratory-viruses.html#cb69-2" tabindex="-1"></a>  </span>
<span id="cb69-3"><a href="respiratory-viruses.html#cb69-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>) <span class="sc">==</span> <span class="fu">year</span>(start_date) <span class="sc">|</span></span>
<span id="cb69-4"><a href="respiratory-viruses.html#cb69-4" tabindex="-1"></a>           <span class="fu">year</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>) <span class="sc">==</span> <span class="fu">year</span>(end_date)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-5"><a href="respiratory-viruses.html#cb69-5" tabindex="-1"></a>  </span>
<span id="cb69-6"><a href="respiratory-viruses.html#cb69-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb69-7"><a href="respiratory-viruses.html#cb69-7" tabindex="-1"></a>    <span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb69-8"><a href="respiratory-viruses.html#cb69-8" tabindex="-1"></a>      modified <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">~</span> <span class="fu">paste</span>(</span>
<span id="cb69-9"><a href="respiratory-viruses.html#cb69-9" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">month</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>)),</span>
<span id="cb69-10"><a href="respiratory-viruses.html#cb69-10" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">day</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>)), <span class="at">sep=</span><span class="st">&quot;-&quot;</span></span>
<span id="cb69-11"><a href="respiratory-viruses.html#cb69-11" tabindex="-1"></a>        ),</span>
<span id="cb69-12"><a href="respiratory-viruses.html#cb69-12" tabindex="-1"></a>      modified <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste</span>(</span>
<span id="cb69-13"><a href="respiratory-viruses.html#cb69-13" tabindex="-1"></a>        <span class="st">&quot;&quot;</span>,</span>
<span id="cb69-14"><a href="respiratory-viruses.html#cb69-14" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">month</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>)),</span>
<span id="cb69-15"><a href="respiratory-viruses.html#cb69-15" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">day</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>)), <span class="at">sep=</span><span class="st">&quot;-&quot;</span></span>
<span id="cb69-16"><a href="respiratory-viruses.html#cb69-16" tabindex="-1"></a>        )</span>
<span id="cb69-17"><a href="respiratory-viruses.html#cb69-17" tabindex="-1"></a>      ),</span>
<span id="cb69-18"><a href="respiratory-viruses.html#cb69-18" tabindex="-1"></a>    <span class="st">`</span><span class="at">MMWR Year</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">MMWR Year</span><span class="st">`</span>)</span>
<span id="cb69-19"><a href="respiratory-viruses.html#cb69-19" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb69-20"><a href="respiratory-viruses.html#cb69-20" tabindex="-1"></a>  </span>
<span id="cb69-21"><a href="respiratory-viruses.html#cb69-21" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Age Group</span><span class="st">`</span>, <span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-22"><a href="respiratory-viruses.html#cb69-22" tabindex="-1"></a>  <span class="fu">tally</span>(<span class="at">name =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-23"><a href="respiratory-viruses.html#cb69-23" tabindex="-1"></a>  </span>
<span id="cb69-24"><a href="respiratory-viruses.html#cb69-24" tabindex="-1"></a>  <span class="co"># 1. Group by epi week and total weekly cases</span></span>
<span id="cb69-25"><a href="respiratory-viruses.html#cb69-25" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-26"><a href="respiratory-viruses.html#cb69-26" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;Total&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(Count)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-27"><a href="respiratory-viruses.html#cb69-27" tabindex="-1"></a>  </span>
<span id="cb69-28"><a href="respiratory-viruses.html#cb69-28" tabindex="-1"></a>  <span class="co"># 2. Calculate proportions</span></span>
<span id="cb69-29"><a href="respiratory-viruses.html#cb69-29" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-30"><a href="respiratory-viruses.html#cb69-30" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;Proportion&quot;</span> <span class="ot">=</span> Count <span class="sc">/</span> Total) <span class="sc">%&gt;%</span> </span>
<span id="cb69-31"><a href="respiratory-viruses.html#cb69-31" tabindex="-1"></a>  </span>
<span id="cb69-32"><a href="respiratory-viruses.html#cb69-32" tabindex="-1"></a>  <span class="fu">complete</span>(<span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>, <span class="st">`</span><span class="at">Age Group</span><span class="st">`</span>, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">Proportion =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-33"><a href="respiratory-viruses.html#cb69-33" tabindex="-1"></a>  </span>
<span id="cb69-34"><a href="respiratory-viruses.html#cb69-34" tabindex="-1"></a>  <span class="co"># 3. Graph proportions instead of counts</span></span>
<span id="cb69-35"><a href="respiratory-viruses.html#cb69-35" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">MMWR Week</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Proportion</span><span class="st">`</span>, <span class="co"># Change the y-axis values here</span></span>
<span id="cb69-36"><a href="respiratory-viruses.html#cb69-36" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">`</span><span class="at">Age Group</span><span class="st">`</span>,</span>
<span id="cb69-37"><a href="respiratory-viruses.html#cb69-37" tabindex="-1"></a>             <span class="at">group =</span> <span class="st">`</span><span class="at">Age Group</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb69-38"><a href="respiratory-viruses.html#cb69-38" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb69-39"><a href="respiratory-viruses.html#cb69-39" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb69-40"><a href="respiratory-viruses.html#cb69-40" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Week&quot;</span>, <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb69-41"><a href="respiratory-viruses.html#cb69-41" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set3&quot;</span>) <span class="sc">+</span></span>
<span id="cb69-42"><a href="respiratory-viruses.html#cb69-42" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ILI Proportions of ED Visits by Age Group&quot;</span>) <span class="sc">+</span> <span class="co"># Change the plot title</span></span>
<span id="cb69-43"><a href="respiratory-viruses.html#cb69-43" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb69-44"><a href="respiratory-viruses.html#cb69-44" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb69-45"><a href="respiratory-viruses.html#cb69-45" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb69-46"><a href="respiratory-viruses.html#cb69-46" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb69-47"><a href="respiratory-viruses.html#cb69-47" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb69-48"><a href="respiratory-viruses.html#cb69-48" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb69-49"><a href="respiratory-viruses.html#cb69-49" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/ILI%20Proportions%20by%20Age%20Group-1.png" width="672" /></p>
<p>Now we have a graph of proportions. Though the proportions and counts of ILI for these dates are very similar, that will not always be the case, so don’t expect the counts and proportions graphs to be identical every time.</p>
</div>
</div>
<div id="rendering-and-formatting" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Rendering and formatting<a href="respiratory-viruses.html#rendering-and-formatting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that the graphs are complete, we need to generate (render) and apply formatting to the presentation. <strong>Before you start</strong>, make sure you have replaced the line lists in the Automation folder. You will need to download three line lists: one for CLI (CLI_No_Flu), one for ILI (ILI), and one for RSV (RSV (ICD-9/10-CM or keyword)). When getting the line lists, the “date from” should be the first Sunday of the date range for the prior season, and the “date to” should be the last Saturday of the date range for the current season.</p>
<p>First, open the Automation R project in the Automation folder.</p>
<p><img src="Images/01-rproj.png" /></p>
<p>When RStudio opens, make sure <code>Presentation.qmd</code> is open. If it is not, you can select it in the bottom right part of the screen.</p>
<p>Then, edit your dates. <code>start_date</code> and <code>end_date</code> should be the date range (probably Sunday to Saturday) in which you would like to graph cases for the <strong>current season</strong>. <code>start_date_ly</code> and <code>end_date_ly</code> (<code>ly</code> stands for “last year”) should be the date range that will be graphed from the <strong>prior season</strong> as a comparison. In general, <code>start_date_ly</code> should be a Sunday and <code>end_date_ly</code> should be a Saturday.</p>
<p><img src="Images/02-dates.png" /></p>
<p>Next, click “Render” to generate the presentation. Any errors will appear in the console at the bottom-left.</p>
<p><img src="Images/03-render.png" /></p>
<p>A browser window may open, and the presentation may download. You can delete the file in your downloads and close the browser, because the presentation will appear in your Automation folder. Click <code>Presentation.pptx</code> at the bottom right of RStudio (or open it from the Automation folder in Windows Explorer).</p>
<p><img src="Images/04-pptx.png" /></p>
<p>You can now apply the official county theme to the presentation. Under the Design tab, click the dropdown option for themes, then click “Browse for Themes…”.</p>
<p><img src="Images/05-designtab.png" /></p>
<p>The theme you need is already saved to the Automation folder. Navigate to the folder, then open <code>wake_theme.thmx</code>.</p>
<p><img src="Images/06-thmx.png" /></p>
<p>Now the theme is applied, and you can make any necessary changes to the text (such as the Highlights page).</p>
<p><img src="Images/07-final.png" /></p>
</div>
<div id="final-notes-3" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Final notes<a href="respiratory-viruses.html#final-notes-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Automating presentations in R can be very useful when similar reports need to be produced on a regular basis. Quarto makes this process simple, as you can generate an entire presentation from just one RMarkdown document, and R can be used to process and analyze your data the same way each time.</p>
<p>RStudio also includes the ability, at no cost, to make several other types of projects using the same syntax and environment. For example, this web presentation was generated with Bookdown, which we’ll talk about briefly in the next section.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="stis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bookdown.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
